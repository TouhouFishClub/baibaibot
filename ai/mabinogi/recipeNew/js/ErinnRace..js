var SkillLevelName = ["练习级","F级","E级","D级","C级","B级","A级","9级","8级","7级","6级","5级","4级","3级","2级","1级","1段","2段","3段"];var CELvCoefficient = [0,0.8,1,1.4,2,3];var NowCELv;var NowCEData = -1;var NowCollect = 0;var NowTraining = 0;var NowFynny = 0;var NowPage;var NowPageState = 0;var NowRequirement = -1;var NowRequirementListState = 0;var SiftData;function ShowOption(Requirement){let t = "";let tt = "OptionTable";if(Requirement == 0){let CELvLists = ["非常弱小","弱小","同等级","强悍","非常强悍","BOSS"];for(let i=0;i<CELvLists.length;i++){t+= "</tr><tr><td id='CELv"+i+"' onclick='ChangeCELv("+i+")' onmouseover='MouseOverOption(this)' onmouseout='MouseOutOption(this)'>"+CELvLists[i]+"<br><span name='CEData"+i+"'>0</span>～<span name='CEData"+(i+1)+"'>0</span></td>"}t = "<td><input type='text' onkeyup='CheckCombatEffectiveness()' onafterpaste='CheckCombatEffectiveness()' class='CombatEffectiveness' id='CombatEffectiveness' placeholder='请输入战斗力数值'/></td>"+t;setTimeout("document.getElementsByName('CEData6')[0].innerHTML = '∞';ChangeCELv(0);",0)}else{if([1,2,4].includes(Requirement)){tt = "Option0Table"}switch(Requirement){case 1:for(let i=0;i<CollectList.length;i++){Requirement = eval("Collect"+CollectList[i]);t+= "<td id='Collect"+CollectList[i]+"' onclick='ChangeCollect(&quot;"+CollectList[i]+"&quot;)' onmouseover='MouseOverOption(this)' onmouseout='MouseOutOption(this)'>"+Requirement[0]+"</td></tr><tr>"}break;case 2:for(let i=0;i<TrainingList.length;i++){Requirement = eval("Training"+TrainingList[i]);t+= "<td id='Training"+TrainingList[i]+"' onclick='ChangeTraining(&quot;"+TrainingList[i]+"&quot;)' onmouseover='MouseOverOption(this)' onmouseout='MouseOutOption(this)'>"+Requirement[0]+"</td></tr><tr>"}break;case 3:Requirement = "ABCDE";for(let i=0;i<5;i++){if(i){t+="</tr><tr>"}t+= "<td id='Fynny"+Requirement[i]+"' onclick='ChangeFynny(&quot;"+Requirement[i]+"&quot;)' onmouseover='MouseOverOption(this)' onmouseout='MouseOutOption(this)'><img border='0' src='img/Fynny/"+Requirement[i]+".png'><br>["+Requirement[i]+"等级]</td>"}break;case 4:for(let i=0;i<HauntLists.length;i++){t+= "<td id='HauntLists"+HauntLists[i][0]+"' onclick='ChangeTraining(&quot;"+TrainingList[i]+"&quot;)' onmouseover='MouseOverOption(this)' onmouseout='MouseOutOption(this)'>"+HauntLists[i][0]+"</td></tr><tr>"}}}document.getElementById('Option').innerHTML = CompleteTable(t,tt)}function ChangeRequirement(Requirement,th){if(NowRequirement!= Requirement){if(NowRequirement!= -1){document.getElementById('Requirement'+NowRequirement).className = ""}document.getElementById('Requirement'+Requirement).className = "NowCELv";NowRequirement = Requirement;document.getElementById('RequirementNow').innerHTML = th.innerHTML;ShowOption(Requirement);document.getElementById('Page').innerHTML = "";NoData()}ChangeRequirementListState(0)}function CheckCombatEffectiveness(){let CE = document.getElementById('CombatEffectiveness');let CEData = CheckData(CE.value);let CEDataId;CE.value = CEData;for(let i=1;i<6;i++){CEDataId = document.getElementsByName("CEData"+i);for(var j = 0,k = 0;j < CEDataId.length;j++){CEDataId[j].innerHTML = Math.floor((CELvCoefficient[i] * CEData+k) * 100) / 100;if(CEData!= 0){k=0.01}}}if(CEData!= NowCEData){NowCEData = CEData;SiftCombatEffectiveness()}}function ChangeCELv(CELv){if(CELv!= NowCELv){NowCELv = CELv;for(let i=0;i<6;i++){document.getElementById('CELv'+i).className = ""}document.getElementById('CELv'+CELv).className = "NowCELv";SiftCombatEffectiveness()}}function ChangeCollect(Collect){try{document.getElementById('Collect'+NowCollect).className = ""}catch(e){e}document.getElementById('Collect'+Collect).className = "NowCELv";NowCollect = Collect;SiftCollect(Collect)}function ChangeTraining(Training){try{document.getElementById('Training'+NowTraining).className = ""}catch(e){e}document.getElementById('Training'+Training).className = "NowCELv";NowTraining = Training;SiftTraining(Training)}function ChangeFynny(Fynny){try{document.getElementById('Fynny'+NowFynny).className = ""}catch(e){e}document.getElementById('Fynny'+Fynny).className = "NowCELv";NowFynny = Fynny;SiftFynny(Fynny)}function CheckData(Data){Data = Data.replace(/[^\d\.]/g,'');for(let i=0,j=0;i<Data.length;i++){if(Data[i]=="."){if(j==1){Data = Data.substring(0,i)+Data.substring(i+1);i--}else{j=1}}}if(Data[0]=="."){Data = "0"+Data}while(Data>9999.99){Data = Data.slice(0,Data.length-1)}if(Data.length - Data.indexOf(".")>2){Data = Math.floor(Data * 100) / 100}return Data}function SiftCombatEffectiveness(CEData=NowCEData,CELv=NowCELv){SiftData = [];if(CEData == ""){CEData=0}for(let i=0;i < HauntLists.length;i++){for(let j=1;j < HauntLists[i].length;j++){if((HauntLists[i][j][1]>CELvCoefficient[NowCELv] * CEData)&&(NowCELv==5 || HauntLists[i][j][1] <= CELvCoefficient[NowCELv+1] * CEData)){SiftData. push([HauntLists[i][j][0],HauntLists[i][j][1],HauntLists[i][0]])}}}ShowPage()}function SiftCollect(Collect){SiftData = [];let Race;for(let i=0;i < HauntLists.length;i++){for(let j=1;j < HauntLists[i].length;j++){Race = eval("Race"+HauntLists[i][j][0]);if(Race[1] == Collect){SiftData. push([HauntLists[i][j][0],HauntLists[i][j][1],HauntLists[i][0]])}}}ShowPage()}function SiftTraining(Training){SiftData = [];let Race;for(let i=0;i < HauntLists.length;i++){for(let j=1;j < HauntLists[i].length;j++){Race = eval("Race"+HauntLists[i][j][0]);if(Race[2] == Training &&!UnableTameLists.includes(HauntLists[i][j][0])){SiftData. push([HauntLists[i][j][0],HauntLists[i][j][1],HauntLists[i][0]])}}}ShowPage()}function SiftFynny(Fynny){SiftData = [];let Race;let Training;for(let i=0;i < HauntLists.length;i++){for(let j=1;j < HauntLists[i].length;j++){Race = eval("Race"+HauntLists[i][j][0]);if(Race[2]!=""){Training = eval("Training"+Race[2]);if(Training[4] == Fynny){SiftData. push([HauntLists[i][j][0],HauntLists[i][j][1],HauntLists[i][0]])}}}}ShowPage()}function ChangePageState(PageState){NowPageState = PageState;if(NowPageState & document.getElementById('Page').innerHTML!= ""){OpenPage()}else{ClosePage()}}function OpenPage(){let PT = document.getElementById('PageTable');let P = document.getElementById('Page');if(NowPageState){if(PT.offsetHeight>P.offsetHeight){P.style.maxHeight = P.offsetHeight+10+"px";setTimeout("OpenPage()",1)}}}function ClosePage(){let P = document.getElementById('Page');if(!NowPageState){if(P.offsetHeight>64){P.style.maxHeight = Math.max(64,P.offsetHeight-10)+"px";setTimeout("ClosePage()",1)}}}function ChangeRequirementListState(RequirementListState){NowRequirementListState = RequirementListState;if(NowRequirementListState){OpenRequirementList()}else if(NowRequirement!= -1){CloseRequirementList()}}function OpenRequirementList(){let R = document.getElementById('Requirement');if(NowRequirementListState){if(R.offsetHeight < 560){R.style.height = R.offsetHeight+10+"px";setTimeout("OpenRequirementList()",1)}else{document.getElementById('Requirement').style.height = ""}}}function CloseRequirementList(){let R = document.getElementById('Requirement');if(!NowRequirementListState){if(R.offsetHeight>62){R.style.height = Math.max(52,R.offsetHeight-50)+"px";setTimeout("CloseRequirementList()",1)}}}function ShowData(Page=1){try{document.getElementById('Page'+NowPage).className = ""}catch(e){e}document.getElementById('Page'+Page).className = "NowCELv";NowPage = Page;document.getElementById('Data').innerHTML = "";let Toplimit = Math.min(SiftData.length,Page*8);let Race;for(let i=(Page-1)*8;i<Toplimit;i++){Race = eval("Race"+SiftData[i][0]);document.getElementById('Data').innerHTML+=CompleteTable(TdID(SiftData[i][0])+TdName(Race[0])+TdCEData(SiftData[i][1])+TdCollect(Race[1])+TdTraining(SiftData[i][0])+TdFynny(Race[2])+TdHaunt(SiftData[i][2]),"Sift")}SiftData}function ShowPage(){let t="";let Toplimit = Math.ceil(SiftData.length / 8);for(let i=0;i<Toplimit;){i++;t+= "<td Width=34px onclick='ShowData("+i+")' id=Page"+i+" onmouseover='MouseOverOption(this)' onmouseout='MouseOutOption(this)'>"+i+"</td>";if(i%30==0){t+= "</tr><tr>"}}document.getElementById('Page').innerHTML = CompleteTable(t,"PageTable");if(SiftData.length==0){NoData()}else{ShowData()}}function MouseOverOption(obj){obj.style = "color: white;"}function MouseOutOption(obj){obj.style = ""}function TdEffect(Effect){let t = "";let EffectName = ["最大生命值","最大魔法值","最大体力值","力量","智力","敏捷","意志","幸运","防御","保护"];for(let i=0;i<Effect.length;i+= 2){t+= EffectName[Effect[i]]+" +"+Effect[i+1]+"<br>"}return "<td>"+t+"</td>"}function TdCollectEffect(Effect,a){let EffectList = [["生命值 +1","力量 +1","魔法防御 +1","防御 +1"],["生命值 +25%","力量 +20%","",""]];Effect--;return "<td>"+EffectList[a][Effect]+"</td>"}function ShowCollect(th,Collect){if(Collect == undefined){th.style = "";InitializeTemp()}else{th.style = "border: 1px solid gold;";Collect = eval("Collect"+Collect);let t = "<td>"+CompleteTable(TdText(Collect[0]),"ImgTable")+"</td></tr><tr>";let tt;if([CollectSahuaginsoldier,CollectGoldmaskghost,CollectRobberelf].includes(Collect)){tt = "<td>"+CompleteTable(TdText("未实装"),"ImgTable")+"</td>"}else{if(Collect[2]==100){tt = TdText("自动收集")+"</tr><tr>"}else{tt = TdText("收集次数：")+TdText(Collect[1])+"</tr><tr>";tt+= TdText("收集成功率：")+TdText(Collect[2]+"%")+"</tr><tr>"}tt+= TdText("技能等级：")+TdText(SkillLevelName[Collect[3]])+"</tr><tr>";tt+= TdText("收集奖励：")+TdCollectEffect(Collect[4],0)+"</tr><tr>";tt+= TdText("变身奖励：")+TdCollectEffect(Collect[4],1)}t+= "<td>"+CompleteTable(tt,"ImgTable")+"</td>";document.getElementById("Temp").innerHTML = CompleteTable(t,"TempTable");document.getElementById("Temp").className = "TempShow";let AbsolutePosition = GetPosition(th);let TopPosition = AbsolutePosition[1]+48;document.getElementById("Temp").style.left = AbsolutePosition[0] - parseInt(document.getElementById("Temp").clientWidth) - 20+"px";document.getElementById("Temp").style.top = Math.min(AbsolutePosition[1],parseInt(document.getElementById("MainBodySpan").clientHeight) - parseInt(document.getElementById("Temp").clientHeight) - 5)+"px"}}function ShowTraining(th,Training){if(Training == undefined){th.style = "";InitializeTemp()}else{th.style = "border: 1px solid gold;";Training = eval("Training"+Training);let t = "<td>"+CompleteTable(TdText(Training[0]),"ImgTable")+"</td></tr><tr>";if([TrainingTurtle].includes(Training)){t+= "<td>"+CompleteTable(TdText("未实装"),"ImgTable")+"</td>"}else{t+= "<td>"+CompleteTable(TdText("驯兽奖励：")+TdEffect(Training[3])+"</tr><tr>"+TdText("5 星要求：")+TdText("原始战斗力 "+Training[2]),"ImgTable")+"</td>"}document.getElementById("Temp").innerHTML = CompleteTable(t,"TempTable");document.getElementById("Temp").className = "TempShow";let AbsolutePosition = GetPosition(th);let TopPosition = AbsolutePosition[1];document.getElementById("Temp").style.left = AbsolutePosition[0] - parseInt(document.getElementById("Temp").clientWidth) - 86+"px";document.getElementById("Temp").style.top = Math.min(AbsolutePosition[1],parseInt(document.getElementById("MainBodySpan").clientHeight) - parseInt(document.getElementById("Temp").clientHeight) - 5)+"px"}}function ShowFynny(th,Training){if(Training == undefined){th.style = "";InitializeTemp()}else{th.style = "border: 1px solid gold;";Training = eval("Training"+Training);let t = "<td>"+CompleteTable(TdText("菲尼宝珠："+Training[0]),"ImgTable")+"</td></tr><tr>";document.getElementById("Temp").innerHTML = CompleteTable(t,"TempTable");document.getElementById("Temp").className = "TempShow";let AbsolutePosition = GetPosition(th);let TopPosition = AbsolutePosition[1];let MainBodySpanScrollTop = parseInt(document.getElementById("MainBodySpan").scrollTop);document.getElementById("Temp").style.left = AbsolutePosition[0]+40+"px";document.getElementById("Temp").style.top = Math.max(Math.min(AbsolutePosition[1]-9,MainBodySpanScrollTop+parseInt(document.getElementById("MainBodySpan").clientHeight) - parseInt(document.getElementById("Temp").clientHeight) - 1),MainBodySpanScrollTop+1)+"px"}}function InitializeTemp(){document.getElementById("Temp").innerHTML = "";document.getElementById("Temp").className = "Temp";document.getElementById("Temp").style = ""}function GetPosition(th){let AbsoluteLeft = th.offsetLeft;let AbsoluteTop = th.offsetTop;while(th.offsetParent!= "[object HTMLSpanElement]"){th = th.offsetParent;AbsoluteLeft+= th.offsetLeft;AbsoluteTop+= th.offsetTop}return [AbsoluteLeft,AbsoluteTop]}function CheckImg(){let AllImg=document.getElementsByTagName("img");for(i=0;i < AllImg.length;i++) AllImg[i].onerror=function(){this.src="img/onerror.png"}}
