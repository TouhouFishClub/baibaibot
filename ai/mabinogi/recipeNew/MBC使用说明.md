# MBC (Material Basic Calculator) 功能使用说明

## 功能简介

`mbc` 是一个用于计算洛奇物品实际基础材料需求的功能。它可以递归分析配方，将复合材料分解为最基础的材料，帮助玩家了解制作某个物品真正需要的原材料数量。

## 使用格式

```
mbc 物品名称 [最终材料1,最终材料2,...] [*数量]
```

### 参数说明

- **物品名称**: 要查询的物品名称或ID
- **最终材料**: （可选）设置不再继续分解的材料列表，用方括号包围，多个材料用逗号分隔
- **数量**: （可选）需要制作的数量，用 `*数量` 的格式

## 使用示例

### 1. 基本查询
```
mbc 水果拼盘
```
输出：
```
📊 水果拼盘 (x1) 的基础材料统计:

📋 所需基础材料:
  • 草莓: 0.46
  • 苹果: 0.30
  • 野果: 0.24
```

### 2. 设置最终材料
```
mbc 面包 [小麦粉]
```
当设置小麦粉为最终材料时，系统不会继续分解小麦粉的配方，直接将其计入结果。

### 3. 数量查询
```
mbc 水果拼盘*5
```
计算制作5个水果拼盘需要的材料。

### 4. 复合查询
```
mbc 高级木柴*10 [普通木柴]
```
计算制作10个高级木柴需要的材料，但不分解普通木柴。

### 5. ID查询
```
mbc 50106
```
通过物品ID直接查询。

## 功能特点

1. **递归分析**: 自动分析多层配方关系，找出最基础的材料
2. **最终材料设置**: 可以设置某些材料为最终材料，不再继续分解
3. **多数量计算**: 支持计算制作多个物品的材料需求
4. **智能查找**: 支持模糊匹配和精确匹配
5. **循环检测**: 防止配方循环引用导致的无限递归

## 应用场景

- **制作规划**: 规划大量制作某个物品时需要准备的基础材料
- **成本计算**: 了解制作物品的真实材料成本
- **材料采购**: 确定需要采购哪些基础材料
- **配方分析**: 分析复杂配方的材料构成

## 注意事项

1. 如果物品有多个配方来源，系统会使用第一个找到的配方
2. 某些特殊物品可能没有配方数据，会直接作为基础材料处理
3. 百分比材料会按实际比例计算，结果可能包含小数
4. 最终材料设置对所有层级的配方都生效

## 技术实现

- 支持所有技能类型的配方：料理、打铁、裁缝、纺织、木工等
- 自动加载配方数据和物品数据
- 使用递归算法分析配方依赖关系
- 防循环检测确保计算稳定性
